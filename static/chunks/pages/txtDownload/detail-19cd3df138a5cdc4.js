(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[915],{6047:function(e,t,n){"use strict";var c=n(4942),r=n(1451),o=n(5697),a=n.n(o),i=(n(9919),n(7294)),l=n(2252),s=n(5893);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);t&&(c=c.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,c)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){(0,c.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f=function(e,t){var n=(0,i.useMemo)((function(){var t=e.className.split(" ");return(0,l.k)(["xl-iconfont","xl-icon-".concat(t[0])].concat((0,r.Z)(t.slice(1,t.length))))}),[e.className]),c=(0,i.useMemo)((function(){var t=d({},e.style);return e.size&&(t.fontSize="".concat(e.size,"px")),e.onClick&&(t.cursor="pointer"),t.color=e.color,t}),[e.style,e.size,e.onClick]);return(0,s.jsx)("i",d(d({ref:t},e),{},{className:n,onClick:e.onClick,title:e.title,style:c,children:e.children}))},p=(0,i.forwardRef)(f);p.propTypes={className:a().string,style:a().object,color:a().string,size:a().number,title:a().string,onClick:a().func},p.defaultProps={className:"",size:20,color:""},t.Z=p},8800:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return O},default:function(){return N}});var c=n(4942),r=n(91),o=n(1451),a=n(2252),i=n(7264),l=(n(8454),n(7294)),s=n(1742),u=n(3935),d=n(4258),f=(n(4238),n(4579),n(5893)),p=n(6047),h=n(1664),m=n(4431),x=["chapter","active","disableRouter"];function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);t&&(c=c.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,c)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){(0,c.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function j(e){var t=e.txtInfo,n=(0,l.useState)(t.chapters),c=n[0],r=n[1],a=(0,l.useState)(!0),i=a[0],h=a[1],m=(0,l.useState)(!1),x=m[0],v=m[1],b=(0,l.useState)([]),j=b[0],O=b[1],N=function(e){var t=parseFloat(e),n=(0,o.Z)(j);t<Math.min.apply(Math,(0,o.Z)(j))||t>Math.max.apply(Math,(0,o.Z)(j))?(n[0]=Math.min.apply(Math,[t].concat((0,o.Z)(j))),n[1]=Math.max.apply(Math,[t].concat((0,o.Z)(j))),O(n)):function(e){var t=e.title,n=e.onCancel,c=e.maskClosable,r=e.zIndex,o=(e.centered,e.onOk),a=e.cancelText,i=e.okText,l=document.createElement("div");l.className="modal-container";var s=function(){u.unmountComponentAtNode(l),document.body.removeChild(l)};u.render((0,f.jsx)(d.Z,{title:t,onClose:s,maskClosable:c,zIndex:r,visible:!0,destroyOnClose:!0,children:(0,f.jsxs)("div",{className:"xl-modal--buttons",children:[(0,f.jsx)("div",{className:"xl-modal--button",onClick:function(){null===n||void 0===n||n(),s()},children:a||"\u53d6\u6d88"}),(0,f.jsx)("div",{className:"xl-modal--button",onClick:function(){null===o||void 0===o||o(),s()},children:i||"\u786e\u8ba4"})]})}),l),document.body.appendChild(l)}({zIndex:1e3,maskClosable:!1,centered:!0,title:"\u5f53\u524d\u9009\u4e2d\u7ae0\u8282\u4e3a\uff1f",onOk:function(){n[1]=t,O(n)},onCancel:function(){n[0]=t,O(n)},cancelText:"\u8d77\u59cb",okText:"\u7ec8\u6b62"})},k=(0,l.useRef)(null),g=(0,l.useRef)({}),w=(0,l.useState)(!1),C=w[0],P=w[1],S=(0,l.useState)(0),E=(S[0],S[1]),_=function(e){var t=document.getElementById("xl-ws-msg-panel"),n=document.createElement("div");n.innerHTML=e,null===t||void 0===t||t.insertBefore(n,t.firstChild)};return(0,f.jsxs)("div",{className:"xl-txt-info-main",children:[(0,f.jsxs)("div",{className:"xl-txt-info-header",children:[(0,f.jsx)("img",{className:"cover-img",src:t.coverImg||"https://ttppl.xyz/file/id/70",alt:"\u5c01\u9762\u56fe"}),(0,f.jsxs)("div",{className:"book-info",children:[(0,f.jsx)("p",{className:"book-name",children:t.name}),(0,f.jsx)("p",{className:"book-author",children:t.author}),(0,f.jsxs)("div",{className:"book-other-info",children:[(0,f.jsx)("p",{children:t.lastUpdateTime}),(0,f.jsx)("p",{children:t.newestChapter})]}),(0,f.jsx)("div",{className:"book-abstract",title:t.abstract,children:t.abstract})]})]}),(0,f.jsx)("div",{className:"xl-mobile-abstract",children:t.abstract}),(0,f.jsxs)("div",{className:(0,s.ll)(["xl-txt-info-chapters",{"download-mode":x}]),children:[(0,f.jsxs)("div",{className:"xl-chapters-function-bar",children:[(0,f.jsx)("div",{className:"xl-button",onClick:function(){r(c.reverse()),h(!i)},children:i?"\u5012\u5e8f":"\u6b63\u5e8f"}),(0,f.jsx)("div",{className:"xl-button",onClick:function(){v(!x)},children:x?"\u9605\u8bfb\u6a21\u5f0f":"\u4e0b\u8f7d\u6a21\u5f0f"}),x&&(0,f.jsx)("div",{className:"xl-button",onClick:function(){1!==j[0]&&j[1]!==c.length?O([1,c.length]):O([])},children:1!==j[0]&&j[1]!==c.length?"\u5168\u9009":"\u5168\u4e0d\u9009"}),x&&(0,f.jsx)("div",{className:"xl-button",onClick:function(){P(!0);var e=new WebSocket("".concat("wss://ttppl.xyz","/ws/downloadTxt"));k.current=e,e.addEventListener("open",(function(n){_("\u670d\u52a1\u5668\u5df2\u8fde\u63a5..."),e.send(JSON.stringify({name:t.name,href:t.href,chapters:j,chapterSplicer:t.chapterSplicer}))})),e.addEventListener("message",(function(e){var t=e.data;if(t.startsWith("$"))_(t.slice(1));else{var n=JSON.parse(t);null!==n&&void 0!==n&&n.id&&(g.current=n)}})),e.addEventListener("close",(function(e){g.current.id&&(_("\u5f02\u6b65\u4e0b\u8f7d\u6587\u4ef6\u4e2d..."),(0,s.B8)("".concat("https://ttppl.xyz/file/id/").concat(g.current.id),{fileName:"".concat(g.current.fileName,".").concat(g.current.fileType),onProgress:function(e){E(100*e)}}).then((function(){P(!1)})))}))},children:"\u4e0b\u8f7d"})]}),c.map((function(e,t){return(0,f.jsx)(y,{disableRouter:x,active:x&&e.chapterIndex>=j[0]&&e.chapterIndex<=j[1],onClick:function(){return x&&N(e.chapterIndex)},chapter:e},e.name+t)}))]}),C&&(0,f.jsxs)("div",{id:"xl-ws-msg-panel",children:[(0,f.jsx)(p.Z,{className:"close close-icon",onClick:function(){var e;console.log("\u53d6\u6d88\u4e0b\u8f7d..."),null===(e=k.current)||void 0===e||e.close(),P(!1)}}),(0,f.jsx)("div",{children:"\u521d\u59cb\u5316\u8fde\u63a5..."})]})]})}function y(e){var t=e.chapter,n=e.active,c=e.disableRouter,o=(0,r.Z)(e,x);return(0,f.jsx)("div",b(b({},o),{},{className:(0,s.ll)(["xl-txt-chapter-item",{active:n}]),children:(0,f.jsx)(h.default,{href:{pathname:"/txtDownload/chapter",query:{key:(0,a.bl)(t.url)}},passHref:!0,children:(0,f.jsx)("a",{className:(0,s.ll)({"reading-mode":!c}),onClick:function(e){c?e.preventDefault():(0,m.Z)(!0,{label:"\u7ae0\u8282\u3010".concat(t.name,"\u3011\u51c6\u5907\u4e2d...")})},children:t.name})})}))}j.layout=i.uy;var O=!0,N=j},5655:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/txtDownload/detail",function(){return n(8800)}])},9919:function(){},4579:function(){},8454:function(){}},function(e){e.O(0,[662,878,853,116,774,888,179],(function(){return t=5655,e(e.s=t);var t}));var t=e.O();_N_E=t}]);